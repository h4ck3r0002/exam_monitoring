{% extends 'base.html' %}
{% load static %}
{% block title %} Kết quả {% endblock title %}

{% block content %}
<div class="container py-4">
    <h2 class="text-center text-dark fw-bold mb-4">Exam Result</h2>
    <div class="mb-4">
        <p><strong>Exam:</strong> {{ result.exam.title }}</p>
        <p><strong>User:</strong> {{ request.user.username }}</p>
        <p><strong>Score:</strong> {{ result.score }}</p>
        <p><strong>Trạng thái gian lận:</strong> 
            <span class="fw-bold {% if result.is_cheat %} text-danger {% else %} text-success {% endif %}">
                {% if result.is_cheat %} Có {% else %} Không {% endif %}
            </span>
        </p>
    </div>
    <ul class="list-unstyled">
        {% for detail in result.resultdetail_set.all %}
            <li class="card mb-4 shadow-sm border-0">
                <div class="card-body">
                    <p class="card-title"><strong>Question:</strong> {{ detail.question.question_text }}</p>
                    <ul class="list-unstyled">
                        {% for answer in detail.question.answer_set.all %}
                            <li class="p-2 mb-2 rounded
                                {% if answer == detail.answer and detail.is_correct %} bg-warning
                                {% elif answer == detail.answer and not detail.is_correct %} bg-danger text-white
                                {% endif %}">
                                {{ answer.answer_text }}
                                {% if answer == detail.answer %}
                                    - <span class="fw-bold">Your Choice</span>
                                {% endif %}
                            </li>
                        {% endfor %}
                    </ul>
                    <p><strong>Correct Answer:</strong> 
                        {% for answer in detail.question.answer_set.all %}
                            {% if answer.is_correct %}<span class="text-success">{{ answer.answer_text }}</span>{% endif %}
                        {% endfor %}
                    </p>
                </div>
            </li>
        {% endfor %}
    </ul>
    <div class="text-center">
        <a class="btn btn-primary mb-3" href="{% url 'index' %}">Back to Exams</a>
    </div>
</div>

<style>
    .card {
        border-radius: 8px;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .card:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
    }

    .bg-warning {
        background-color: #ffeb3b !important;
        color: #222;
    }

    .bg-danger {
        background-color: #f44336 !important;
        color: #fff;
    }

    .text-success {
        color: #4caf50 !important;
    }

    .text-danger {
        color: #f44336 !important;
    }

    .text-center {
        text-align: center;
    }

    .fw-bold {
        font-weight: bold;
    }
</style>
{% endblock content %}
